@{
    ViewData["Title"] = "Home Page";
}

<section id="login">
    <div class="container">
        <h4 class="text-center text-uppercase mb-0" id="htext">Login</h4>
        <hr class="star-dark mb-2">
        <div class="row" id="divLogin">
            <div class="col-lg-8 mx-auto">
                @if (ViewBag.error != null)
                {
                    <div class="alert alert-danger">@ViewBag.error</div>
                }
                <form name="sentMessage" id="login" method="post" action="@Url.Action("Login", "Home")">
                    <div class="control-group">
                        <div class="form-group floating-label-form-group controls mb-0 pb-2">
                            <label>Email Address</label>
                            <input class="form-control" name="email" id="email" type="email" placeholder="Email Address" required="required" data-validation-required-message="Please enter your email address.">
                            <p class="help-block text-danger"></p>
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="form-group floating-label-form-group controls mb-0 pb-2">
                            <label>Password</label>
                            <input class="form-control" name="password" id="password" type="password" placeholder="Password" required="required" data-validation-required-message="Please enter your email address.">
                            <p class="help-block text-danger"></p>
                        </div>
                    </div>
                    <br>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary btn-xl" id="loginbutton">Login</button>
                        <a href="javascript:void(0)" id="linkforgot" class="btn btn-link">Forgot Password</a>
                    </div>

                </form>
            </div>
        </div>

        <div class="row d-none" id="divForgot">
            <div id="loading" class="d-none">
                <ul class="bokeh">
                    <li></li>
                    <li></li>
                    <li></li>
                </ul>
            </div>
            <div class="col-lg-8 mx-auto">
                <form name="sentMessage">
                    <div class="alert alert-danger d-none" id="fdanger">There is an issue resetting yur email, Please provide correct information.</div>
                    <div class="alert alert-success d-none" id="fsuccess" style="">Password has been sent to your email address.</div>
                    <div class="control-group">
                        <div class="form-group floating-label-form-group controls mb-0 pb-2">
                            <label>Email Address</label>
                            <input class="form-control" name="femail" id="femail" type="email" placeholder="Email Address" required="required" data-validation-required-message="Please enter your email address.">
                            <p class="help-block text-danger"></p>
                        </div>
                    </div>
                    <div class="form-group">
                        <button type="button" class="btn btn-primary btn-xl" id="forgotbutton">Send</button>
                        <button type="button" class="btn btn-default btn-xl" id="cancelbutton">Cancel</button>
                        <span id="spanClick"></span>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<!-- Register Section -->
<section id="register">
    <div class="container">
        <h4 class="text-center text-uppercase mb-0">Registration</h4>
        <hr class="star-dark mb-2">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                @if (ViewBag.rerror != null)
                {
                    <div class="alert alert-danger">@ViewBag.rerror</div>
                }
                <form action="@Url.Action("Register", "Home")" method="post">
                    <div class="control-group">
                        <div class="form-group floating-label-form-group controls mb-0 pb-2">
                            <label>Name</label>
                            <input class="form-control" name="rname" id="rname" type="text" placeholder="Please enter email address" required="required" data-validation-required-message="Please enter your full name.">
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="form-group floating-label-form-group controls mb-0 pb-2">
                            <label>Email Address</label>
                            <input class="form-control" name="remail" id="remail" type="email" placeholder="Please enter email address" required="required" data-validation-required-message="Please enter your email address.">
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="form-group floating-label-form-group controls mb-0 pb-2">
                            <label>Confirm email address</label>
                            <input class="form-control" name="cemail" id="cemail" type="email" placeholder="Confirm email address" required="required" data-validation-required-message="Please enter your email address again.">
                            <p class="help-block text-danger" id="eerror" style="display:none;">Email address and Confirm Email Address are not matched.</p>
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="form-group floating-label-form-group controls mb-0 pb-2">
                            <label>Password</label>
                            <input class="form-control" name="rpassword" id="rpassword" type="password" placeholder="Please enter password" required="required" data-validation-required-message="Please enter your password.">
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="form-group floating-label-form-group controls mb-0 pb-2">
                            <label>Confirm password</label>
                            <input class="form-control" name="cpassword" id="cpassword" type="password" placeholder="Confirm password" required="required" data-validation-required-message="Please enter your password again.">
                            <p class="help-block text-danger" id="perror" style="display:none;">Password and Confirm Password are not matched.</p>
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="form-group floating-label-form-group controls mb-0 pb-2">
                            <label>Activation code</label>
                            <input class="form-control" name="activationcode" id="activationcode" type="password" placeholder="Please enter activation code" required="required" data-validation-required-message="Please enter activation code.">
                        </div>
                    </div>
                    <br>
                    <div id="success"></div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary btn-xl" id="registerButton">Register</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<!-- Contact Section -->
<section id="contact">
    <div class="container">
        <h4 class="text-center text-uppercase mb-0">Contact Me</h4>
        <hr class="star-dark mb-0">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <form name="sentMessage" id="contactForm">
                    <div class="control-group">
                        <div class="form-group floating-label-form-group controls mb-0 pb-2">
                            <label>Name</label>
                            <input class="form-control" id="cname" type="text" placeholder="Name" required="required" data-validation-required-message="Please enter your name.">
                            @*<p class="help-block text-danger"></p>*@
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="form-group floating-label-form-group controls mb-0 pb-2">
                            <label>Email Address</label>
                            <input class="form-control" id="cemail" type="email" placeholder="Email Address" required="required" data-validation-required-message="Please enter your email address.">
                            @*<p class="help-block text-danger"></p>*@
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="form-group floating-label-form-group controls mb-0 pb-2">
                            <label>Phone Number</label>
                            <input class="form-control" id="cphone" type="tel" placeholder="Phone Number" required="required" data-validation-required-message="Please enter your phone number.">
                            @*<p class="help-block text-danger"></p>*@
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="form-group floating-label-form-group controls mb-0 pb-2">
                            <label>Message</label>
                            <textarea class="form-control" id="cmessage" rows="5" placeholder="Message" required="required" data-validation-required-message="Please enter a message."></textarea>
                            @*<p class="help-block text-danger"></p>*@
                        </div>
                    </div>
                    <br>
                    <div id="success"></div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary btn-xl" id="sendMessageButton">Send</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        $(document).ready(function () {
            $('#registerButton').click(function () {
                $('#eerror').attr('style', 'display:none;');
                $('#perror').attr('style', 'display:none;');

                if ($('#remail').val() !== $('#cemail').val()) {
                    $('#eerror').attr('style', 'display:block;');
                    return false;
                }
                if ($('#rpassword').val() != $('#cpassword').val()) {
                    $('#perror').attr('style', 'display:block;');
                    return false;
                }
            });

            $('#linkforgot').click(function () {
                $('#divLogin').removeClass('d-block').addClass('d-none');
                $('#divForgot').removeClass('d-none').addClass('d-block');
                $('#htext').html('Forgot Password');
            });

            $('#cancelbutton').click(function () {
                $('#divForgot').removeClass('d-block').addClass('d-none');
                $('#divLogin').removeClass('d-none').addClass('d-block');
                $('#htext').html('Login');
            });

            function validateEmail(email) {
                var re = /^(([^<>()\[\]\\.,;:\s@@"]+(\.[^<>()\[\]\\.,;:\s@@"]+)*)|(".+"))@@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                return re.test(String(email).toLowerCase());
            }

            $('#forgotbutton').click(function () {
                var email = $('#femail').val();
                if (email === '') {
                    return;
                }
                if (!validateEmail(email)) {
                    return;
                }
                
                $('#loading').removeClass('d-none').addClass('d-block');
                $.post(window.location.origin + "/Home/ForgotPassword", { 'Email': email }, function (data) {
                    $('#loading').removeClass('d-block').addClass('d-none');
                    if (data) {
                        $('#fsuccess').removeClass('d-none').addClass('d-block');
                    }
                    else {
                        $('#fdanger').removeClass('d-none').addClass('d-block');
                    }
                   
                    setTimeout(function () {
                        $('#fsuccess').removeClass('d-block').addClass('d-none');
                        $('#fdanger').removeClass('d-block').addClass('d-none');
                    }, 6000);

                });
                e.preventDefault();
                alert('it works!');
                return false;
            });

            $('#sendMessageButton').click(function () {
                var name = $('#cname').val();
                var email = $('#cemail').val();
                var phone = $('#cphone').val();
                var message = $('#cmessage').val();
                if (name == '' && email == '' && phone == '' && message == '') {
                    return;
                }
                if (!validateEmail(email)) {
                    return;
                }
                var body = {
                    'Name': name,
                    'Email': email,
                    'Phone': phone,
                    'Message': message
                }
                $.post(window.location.origin + "/Home/Contact", body, function (data) {
                    if (data) {
                        $('#csuccess').removeClass('d-none').addClass('d-block');
                    }
                    else {
                        $('#cdanger').removeClass('d-none').addClass('d-block');
                    }

                    setTimeout(function () {
                        $('#csuccess').removeClass('d-block').addClass('d-none');
                        $('#cdanger').removeClass('d-block').addClass('d-none');
                    }, 6000);

                });
            });

        });
    </script>
}